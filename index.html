<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Domino Scoreboard</title>

<style>
    body {
        margin: 0;
        font-family: -apple-system, BlinkMacSystemFont, sans-serif;
        background: #111;
        color: white;
        display: flex;
        flex-direction: column;
        height: 100vh;
    }

    .top-bar {
        text-align: center;
        padding: 10px;
        background: #1a1a1a;
        font-size: 24px;
    }

    .top-bar input {
        font-size: 24px;
        width: 120px;
        text-align: center;
        border-radius: 8px;
        border: none;
        padding: 6px;
    }

    .container {
        display: flex;
        flex: 1;
    }

    .player {
        flex: 1;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        border-right: 2px solid #333;
        transition: background 0.3s;
    }

    .player:last-child {
        border-right: none;
    }

    .winner {
        background: #1f4d1f;
    }

    .name {
        margin-bottom: 20px;
        font-weight: bold;
    }

    .score {
        margin: 20px 0;
        font-weight: bold;
    }

    .buttons {
        display: flex;
        gap: 15px;
    }

    button {
        font-size: 30px;
        padding: 20px 40px;
        border: none;
        border-radius: 16px;
        background: #2d6cdf;
        color: white;
    }

    button:active {
        transform: scale(0.95);
    }

    .minus {
        background: #555;
    }

    .reset {
        background: #cc3333;
        font-size: 26px;
        padding: 12px 30px;
        margin: 10px auto;
        border-radius: 12px;
    }

    .modal {
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.8);
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        gap: 20px;
    }

    .modal button {
        font-size: 32px;
        padding: 20px 50px;
    }
</style>
</head>

<body>

<div class="top-bar">
    Play to:
    <input type="number" id="targetScore" min="5" step="5">
</div>

<div class="container" id="gameContainer"></div>

<button class="reset" onclick="startSetup()">Reset Game</button>

<script>

let players = [];
let target = 150;

function vibrate() {
    if (navigator.vibrate) navigator.vibrate(30);
}

function saveGame() {
    localStorage.setItem("players", JSON.stringify(players));
    localStorage.setItem("target", target);
}

function loadGame() {
    const savedPlayers = localStorage.getItem("players");
    if (savedPlayers) {
        players = JSON.parse(savedPlayers);
        target = parseInt(localStorage.getItem("target")) || 150;
        document.getElementById("targetScore").value = target;
        renderPlayers();
    } else {
        startSetup();
    }
}

function renderPlayers() {
    const container = document.getElementById("gameContainer");
    container.innerHTML = "";

    const count = players.length;

    let nameSize = count === 2 ? "42px" : count === 3 ? "34px" : "28px";
    let scoreSize = count === 2 ? "140px" : count === 3 ? "110px" : "90px";

    players.forEach((player, index) => {
        const div = document.createElement("div");
        div.className = "player";
        div.id = "player" + index;

        div.innerHTML = `
            <div class="name" style="font-size:${nameSize}">
                ${player.name}
            </div>
            <div class="score" id="score${index}" style="font-size:${scoreSize}">
                ${player.score}
            </div>
            <div class="buttons">
                <button class="minus" onclick="changeScore(${index}, -5)">-5</button>
                <button onclick="changeScore(${index}, 5)">+5</button>
            </div>
        `;

        container.appendChild(div);
    });

    checkWinner();
}

function changeScore(index, amount) {
    vibrate();
    players[index].score += amount;
    document.getElementById("score" + index).innerText = players[index].score;
    saveGame();
    checkWinner();
}

function checkWinner() {
    players.forEach((player, index) => {
        const box = document.getElementById("player" + index);
        box.classList.remove("winner");
        if (player.score >= target) {
            box.classList.add("winner");
        }
    });
}

function startSetup() {
    const modal = document.createElement("div");
    modal.className = "modal";
    modal.innerHTML = `
        <div style="font-size:32px;">How many players?</div>
        <button onclick="choosePlayers(2)">2</button>
        <button onclick="choosePlayers(3)">3</button>
        <button onclick="choosePlayers(4)">4</button>
    `;
    document.body.appendChild(modal);
}

function choosePlayers(count) {
    document.querySelector(".modal").remove();
    players = [];

    for (let i = 0; i < count; i++) {
        let name = prompt("Enter name for Player " + (i + 1));
        players.push({
            name: name || "Player " + (i + 1),
            score: 0
        });
    }

    saveGame();
    renderPlayers();
}

document.getElementById("targetScore").addEventListener("input", function() {
    target = parseInt(this.value) || 150;
    saveGame();
    checkWinner();
});

window.onload = loadGame;

</script>

</body>
</html>